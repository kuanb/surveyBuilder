<!DOCTYPE HTML>
<html>

<head>
  <title>Flocktracker</title>

  <!-- css libraries -->
  <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="/bower_components/font-awesome/css/font-awesome.min.css">
  
  <!-- js base libs -->
  <script src="/bower_components/jquery/dist/jquery.min.js"></script>
  <script src="/bower_components/jquery-ui/jquery-ui.min.js"></script>

  <!-- ng source -->
  <script src="/bower_components/angular/angular.min.js"></script>

  <!-- ng models/directive -->
  <script src="/bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
  <script src="/bower_components/angular-ui/build/angular-ui.min.js"></script>
  <script type="text/javascript" src="/bower_components/angular-ui-sortable/sortable.min.js"></script>

  <link rel="stylesheet" href="/static/style/main.css"> 

  <script src="example.json"></script>
  <script src="/static/scripts/main.js"></script>

  <!-- supporting libraries -->
  <script src="/static/scripts/flockSON.js"></script>
  <script src="/static/scripts/flocktracker-project-models.js"></script>



</head>

<body ng-app="surveyBuilderApp" ng-controller="surveyBuilder">

  <nav class="navbar">
    <div class="navbar-header">
      <a class="navbar-brand" ui-sref="projects">
        <img src="/static/gfx/logo.svg" class="logo"></img>
      </a>
    </div>
    <div class="navbar-header">
      <a ui-sref="projects">
        <h3><b>Flocktracker</b> Survey Builder</h3>
      </a>
    </div>
    <div id="navbar">
      <ul class="nav navbar-nav pull-right">
      	<!-- maybe later -->
      </ul>
    </div>
  </nav>


	<div class="container">
		<tabset >
			<tab heading="Survey">
				<div ng-controller="surveyController">
					<div ui-sortable ng-model="flockSON.FlocktrackerProject.SurveyProject.Survey.Chapters">
						<div ng-repeat="(chapIndex, chapter) in flockSON.FlocktrackerProject.SurveyProject.Survey.Chapters" class="panel panel-default">
		          <div class="panel-heading">
		            <h4 class="panel-title">
		            	<span ng-click="sort[chapter.Chapter.Title] = !sort[chapter.Chapter.Title]">
		            		Chapter {{ chapIndex+1 }}: {{ chapter.Chapter.Title }}
		            	</span>
		            	<i class="fa fa-times-circle-o pull-right" ng-click="removeChapter(chapIndex)"></i>
		            </h4>
		          </div>
		          <div class="panel-body" ng-show="sort[chapter.Chapter.Title]">
		          	<div ui-sortable ng-model="chapter.Chapter.Questions">
				          <div class="panel panel-default" ng-repeat="(questionIndex, question) in chapter.Chapter.Questions">
										<div class="panel-heading">
											<span ng-click="sort[question.Question.Text] = !sort[question.Question.Text]">
												{{ questionIndex+1 }}. {{ question.Question.Text }}
											</span>
				          		<span class="label label-info">ID: {{ question.Question.ID }}</span> 
				          		<span class="label label-info" ng-show="question.Question.JumpID">Jump ID: {{ question.Question.JumpID }}</span> 
				          		<span class="label label-info">Kind: {{ question.Question.Kind }}</span> 
											<i class="fa fa-times-circle-o pull-right" ng-click="removeQuestion(chapIndex, questionIndex)"></i>
										</div>
										<ol class="list-group" ui-sortable ng-model="question.Question.Answers" ng-show="sort[question.Question.Text]">
											<li class="list-group-item" ng-repeat="(answerIndex, answer) in question.Question.Answers">
												{{ answerIndex+1 }}. {{ answer.Answer.Text }}
											</li>
										</ol>
			          	</div>
			          </div>
			        </div>
			        <div class="panel-footer" ng-show="sort[chapter.Chapter.Title]">
				        <div class="text-right">
				        	<span class="label label-info">ID: {{ chapter.newQuestion.ID ? chapter.newQuestion.ID : 'None Selected' }}</span> 
				        	<span class="label label-info">Kind: {{ chapter.newQuestion.Kind ? chapter.newQuestion.Kind : 'None Selected' }}</span> 
				        	<span class="label label-info">JumpID: {{ chapter.newQuestion.JumpID ? chapter.newQuestion.JumpID : 'None Selected' }}</span> 
				        </div>

			          <div class="row">
							    <div class="col-xs-3">
							    	<label>Question ID <small>(no spaces)</small></label>
							      <input class="form-control" 
							      				ng-model="chapter.newQuestion.ID"
							      				ng-keypress="cleanQuestionID(chapter)"
							      				placeholder="New question id">
							    </div>
							    <div class="col-xs-9">
							    	<label>Question Text</label>
							      <input class="form-control" ng-model="chapter.newQuestion.Text" placeholder="New question text">
							    </div>
								</div>
			        </div>
		        </div>

					</div>

					<div class="panel panel-default">
	          <div class="panel-heading">
	            <h4 class="panel-title">
	            	Create a new chapter
	            </h4>
	          </div>
	          <div class="panel-body row">
					    <div class="col-xs-10">
					      <input class="form-control" id="newChapter" placeholder="New chapter title">
					    </div>
					    <div class="col-xs-2 text-right">
					      <button type="submit" class="btn btn-default" ng-click="addNewChapter()">Add Chapter</button>
					    </div>
						</div>
					</div>
				</div>
				
			</tab>
			<tab heading="Tracker">
				{{ flockSON.TrackerProject }}
			</tab>
			<tab heading="Counters">
				{{ flockSON.CountersProject }}
			</tab>
		</tabset>
	</div>


  <footer>
    <div class="container text-center">
      <small class="text-muted">Copyright 2015 Urban Launchpad MX, Singapore-MIT Alliance for Research and Technology</small>
    </div>
  </footer>

</body>

</html>